{% extends "base.html" %}
{% load static %}

{% block content %}

<div class="container-fluid">

    <!-- Intro Section -->
    <div class="row">
        <div class="col-12 intro-text text-center">
            <h1>Customer Reviews</h1>
            <p>
                Hear from our customers and discover why our services are truly out of this world! 
                Read reviews, check ratings, and find out what makes us a favorite.
            </p>
        </div>
    </div>
    
    <!-- Display Reviews -->
    <div class="tab-content mt-3">
        {% for category in review_categories %}
        <div class="tab-pane fade {% if forloop.first %}show active{% endif %}" id="{{ category.name|slugify }}">
            <div class="container">
                {% for review in reviews %}
                {% if review.category == category %}
                <div class="row align-items-center py-3 border-bottom">
                    <!-- Review Content -->
                    <div class="col-md-9">
                        <h5 class="mb-1">{{ review.title }}</h5>
                        <p class="text-muted mb-2">{{ review.body|truncatewords:20 }}</p>
    
                        <!-- Rating -->
                        <p class="mb-1"><strong>Rating:</strong> {{ review.get_rating_display }}</p>
    
                        <!-- Author Name and Date -->
                        <p class="card-text text-muted h6">By {{ review.author.username }} on {{ review.created_on|date:"F j, Y" }}</p>
                    </div>
    
                    <!-- Category Badge (if any) -->
                    <div class="col-md-3">
                        <span class="badge bg-primary">{{ category.name }}</span>
                    </div>
                </div>
                {% endif %}
                {% endfor %}
            </div>
        </div>
        {% endfor %}
    </div>
    
    
    {% if reviews|length == 0 %}
        <p class="text-muted text-center">No reviews have been posted yet.</p>
    {% endif %}
    

    <!-- Review Form (Below reviews) -->
    <div class="row mt-5">
        <div class="col-12">
            <h3>Submit Your Review</h3>
            <form method="POST">
                {% csrf_token %}
                {{ form.as_p }}  <!-- Renders the form fields -->
                <button type="submit" class="btn btn-primary">Submit Review</button>
            </form>
        </div>
    </div>

</div>

{% endblock %}

{% block copyright %}
    Copyright 2025 Bryan Gonzalez
{% endblock %}
